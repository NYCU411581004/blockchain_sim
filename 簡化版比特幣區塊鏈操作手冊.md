# 簡化版比特幣區塊鏈操作手冊

# 簡化版比特幣區塊鏈操作手冊

## 1. 簡介

本文件提供對 `blockchain_sim.py` 的操作指南，並解釋各指令的含義及其設計背後的原因。本程式為一個簡化的區塊鏈模擬器，展示了基本的區塊鏈運作機制，包括區塊的建立、交易的加入、哈希運算、PoW 挖礦機制等。本版本支援 Docker 容器化運行，方便快速部署與管理。

## 2. 執行環境

### 2.1 必要套件

請確保您的環境已安裝 Python（建議使用 Python 3.8 以上版本）。如果程式依賴額外的 Python 套件，請先執行以下命令來安裝：

```
pip install -r requirements.txt

```

(如果 `requirements.txt` 不存在，請直接安裝 `hashlib` 和 `time`，這些是標準庫，不需要額外安裝。)

### 2.2 執行方式

### 本地運行

在終端機中輸入以下指令執行程式：

```
python blockchain_sim.py

```

### Docker 運行

本專案已支援 Docker 容器化，可使用以下步驟執行。

1. **進入專案目錄**：

```
cd blockchain_sim

```

1. **建立 Docker 映像**：

```
docker build -t blockchain-sim .

```

1. **運行容器**：

基本運行（5個參與者）：

```
docker run blockchain-sim

```

啟用除錯模式：

```
docker run blockchain-sim --debug

```

指定參與者數量：

```
docker run blockchain-sim --parties 3

```

同時使用多個參數：

```
docker run blockchain-sim --debug --parties 3

```

## 3. 主要功能與指令說明

### 3.1 建立區塊鏈（Blockchain 類別）

程式的核心是 `Blockchain` 類別，該類別負責管理整個區塊鏈，包括交易、區塊以及挖礦機制。

- **`__init__()`**
    - 初始化區塊鏈，並創建創世區塊（Genesis Block）。
    - 創世區塊的 `previous_hash` 設為 `0`，代表它是鏈的起點。
    - 原因：區塊鏈的第一個區塊沒有前一個區塊，因此需要一個特殊的標記。

### 3.2 新增交易（`add_transaction` 方法）

```python
blockchain.add_transaction(sender, receiver, amount)

```

- **功能**：將交易加入到區塊鏈的待處理交易池中。
- **參數**：
    - `sender`：交易發送者。
    - `receiver`：交易接收者。
    - `amount`：交易金額。
- **原因**：區塊鏈的交易需要先被加入交易池，稍後才能被打包進區塊。

### 3.3 挖礦（`mine_block` 方法）

```python
blockchain.mine_block(miner_address)

```

- **功能**：執行 PoW 挖礦機制，並將交易打包進新的區塊。
- **參數**：
    - `miner_address`：礦工的地址，用於獲取區塊獎勵。
- **原因**：
    - 挖礦是區塊鏈的核心機制之一，透過 PoW（Proof of Work）確保區塊的有效性。
    - 礦工需要計算哈希值，使其符合難度要求（如前導 `0` 的數量）。
    - 獎勵礦工，確保系統有動機來維護區塊鏈。

### 3.4 取得區塊鏈資訊（`get_chain` 方法）

```python
blockchain.get_chain()

```

- **功能**：回傳目前的區塊鏈。
- **原因**：用戶可以查看區塊鏈的完整歷史，驗證交易。

### 3.5 驗證區塊鏈（`is_chain_valid` 方法）

```python
blockchain.is_chain_valid()

```

- **功能**：檢查區塊鏈的完整性，確保沒有區塊被篡改。
- **原因**：
    - 確保區塊的哈希值與前一個區塊的哈希值匹配。
    - 防止惡意用戶竄改交易數據。

## 4. Docker 常見問題與解決方案

### 權限問題

```
# Linux/Mac
sudo docker build -t blockchain-sim .
sudo docker run blockchain-sim

```

### 端口衝突

```
docker run -p 8080:8080 blockchain-sim

```

### 查看日誌

```
docker logs blockchain-sim

```

### 清理環境

如果需要清理 Docker 環境：

```
# 停止所有容器
docker stop $(docker ps -a -q)

# 刪除所有容器
docker rm $(docker ps -a -q)

# 刪除映像
docker rmi blockchain-sim

```

## 5. 擴充建議

- **引入 P2P 網路**：目前區塊鏈僅限於單機運行，可透過 Flask 或 WebSocket 建立節點間的通訊。
- **智能合約支持**：允許更複雜的交易邏輯。
- **共識機制改進**：可以嘗試 PoS（Proof of Stake）等不同共識機制。

## 6. 結論

這份文件提供了 `blockchain_sim.py` 的操作指南，並解釋了各指令的目的與設計原因。透過這個簡化版本的區塊鏈，你可以學習到區塊鏈的核心概念，並進一步改進以符合更高階的應用需求。